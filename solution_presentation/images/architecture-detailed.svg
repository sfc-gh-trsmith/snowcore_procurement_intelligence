<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 900">
  <defs>
    <!-- Gradients -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0D1117"/>
      <stop offset="100%" style="stop-color:#161B22"/>
    </linearGradient>
    <linearGradient id="snowflakeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0D2840"/>
      <stop offset="100%" style="stop-color:#0A1628"/>
    </linearGradient>
    <linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#29B5E8"/>
      <stop offset="100%" style="stop-color:#1E8BB8"/>
    </linearGradient>
    <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#6BCB77"/>
      <stop offset="100%" style="stop-color:#4AA654"/>
    </linearGradient>
    <!-- Filters -->
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="3" stdDeviation="5" flood-color="#000000" flood-opacity="0.35"/>
    </filter>
    <!-- Arrow markers -->
    <marker id="arrowBlue" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 L2,3 Z" fill="#29B5E8"/>
    </marker>
    <marker id="arrowGreen" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 L2,3 Z" fill="#6BCB77"/>
    </marker>
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 L2,3 Z" fill="#444C56"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="900" fill="url(#bgGradient)"/>
  
  <!-- Title -->
  <text x="700" y="35" text-anchor="middle" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="600">Technical Architecture - L2 Detailed View</text>
  <text x="700" y="58" text-anchor="middle" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="12">Intelligent Sourcing Hub Implementation Patterns</text>
  
  <!-- ==================== DATA SOURCES LAYER ==================== -->
  <g transform="translate(20, 80)">
    <!-- Section header -->
    <rect width="200" height="30" rx="4" fill="#FF6B6B" opacity="0.2"/>
    <text x="100" y="20" text-anchor="middle" fill="#FF6B6B" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">DATA SOURCES</text>
    
    <!-- Internal Systems -->
    <g transform="translate(0, 45)" filter="url(#dropShadow)">
      <rect width="200" height="280" rx="10" fill="#21262D" stroke="#FF6B6B" stroke-width="1"/>
      <text x="15" y="25" fill="#FF6B6B" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="600">INTERNAL SYSTEMS</text>
      
      <!-- ERP boxes -->
      <g transform="translate(10, 40)">
        <rect width="85" height="50" rx="4" fill="#2D333B"/>
        <text x="42" y="18" text-anchor="middle" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">SAP (12)</text>
        <text x="42" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">NA, EU regions</text>
        <text x="42" y="43" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">BAPI/RFC</text>
      </g>
      <g transform="translate(105, 40)">
        <rect width="85" height="50" rx="4" fill="#2D333B"/>
        <text x="42" y="18" text-anchor="middle" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">Oracle (18)</text>
        <text x="42" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">EU, LATAM</text>
        <text x="42" y="43" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">DB Link</text>
      </g>
      <g transform="translate(10, 100)">
        <rect width="85" height="50" rx="4" fill="#2D333B"/>
        <text x="42" y="18" text-anchor="middle" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">JDE (15)</text>
        <text x="42" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">APAC</text>
        <text x="42" y="43" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Flat files</text>
      </g>
      <g transform="translate(105, 100)">
        <rect width="85" height="50" rx="4" fill="#2D333B"/>
        <text x="42" y="18" text-anchor="middle" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">BioFlow (5)</text>
        <text x="42" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Life Sciences</text>
        <text x="42" y="43" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">API</text>
      </g>
      
      <!-- Document sources -->
      <g transform="translate(10, 165)">
        <rect width="180" height="45" rx="4" fill="#2D333B" stroke="#FF6B6B" stroke-width="1" stroke-dasharray="3,2"/>
        <text x="90" y="18" text-anchor="middle" fill="#FF6B6B" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">Unstructured Documents</text>
        <text x="90" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="8">Contracts, Audits, Compliance PDFs</text>
      </g>
      
      <!-- Frequency label -->
      <g transform="translate(10, 225)">
        <rect width="180" height="40" rx="4" fill="#1E1E1E"/>
        <text x="90" y="15" text-anchor="middle" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Ingestion Frequency</text>
        <text x="90" y="30" text-anchor="middle" fill="#FF6B6B" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">Daily batch + Event-driven</text>
      </g>
    </g>
    
    <!-- External/Marketplace -->
    <g transform="translate(0, 340)" filter="url(#dropShadow)">
      <rect width="200" height="220" rx="10" fill="#21262D" stroke="#FFD93D" stroke-width="1"/>
      <text x="15" y="25" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="600">SNOWFLAKE MARKETPLACE</text>
      
      <g transform="translate(10, 40)">
        <rect width="180" height="35" rx="4" fill="#2D333B"/>
        <text x="10" y="15" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Financial Risk Scores</text>
        <text x="10" y="27" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">D&amp;B, Experian, FactSet</text>
      </g>
      <g transform="translate(10, 85)">
        <rect width="180" height="35" rx="4" fill="#2D333B"/>
        <text x="10" y="15" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Commodity Indices</text>
        <text x="10" y="27" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">LME, NYMEX, S&amp;P GSCI</text>
      </g>
      <g transform="translate(10, 130)">
        <rect width="180" height="35" rx="4" fill="#2D333B"/>
        <text x="10" y="15" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">ESG Sustainability</text>
        <text x="10" y="27" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">MSCI, Sustainalytics</text>
      </g>
      <g transform="translate(10, 175)">
        <rect width="180" height="35" rx="4" fill="#1E1E1E"/>
        <text x="90" y="15" text-anchor="middle" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Data Sharing</text>
        <text x="90" y="27" text-anchor="middle" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="500">Live, no copy required</text>
      </g>
    </g>
  </g>
  
  <!-- ==================== INGESTION LAYER ==================== -->
  <g transform="translate(240, 80)">
    <rect width="180" height="30" rx="4" fill="#29B5E8" opacity="0.2"/>
    <text x="90" y="20" text-anchor="middle" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">INGESTION</text>
    
    <g transform="translate(0, 45)" filter="url(#dropShadow)">
      <rect width="180" height="515" rx="10" fill="url(#snowflakeGradient)" stroke="#29B5E8" stroke-width="1"/>
      
      <!-- Stages -->
      <g transform="translate(10, 20)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">EXTERNAL STAGES</text>
        <g transform="translate(0, 20)">
          <rect width="160" height="55" rx="4" fill="#21262D"/>
          <text x="10" y="18" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">@ERP_LANDING_STAGE</text>
          <text x="10" y="32" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">S3: s3://snowcore-erp/</text>
          <text x="10" y="45" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Parquet, CSV formats</text>
        </g>
        <g transform="translate(0, 85)">
          <rect width="160" height="40" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">@DOCUMENTS_STAGE</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">PDFs for Cortex Search</text>
        </g>
      </g>
      
      <!-- Snowpipe -->
      <g transform="translate(10, 170)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">AUTO-INGEST</text>
        <g transform="translate(0, 20)">
          <rect width="160" height="70" rx="4" fill="#21262D"/>
          <text x="10" y="18" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">SNOWPIPE</text>
          <text x="10" y="32" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">AUTO_INGEST = TRUE</text>
          <text x="10" y="45" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">SQS notification</text>
          <text x="10" y="58" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="7">Latency: &lt; 1 min</text>
        </g>
      </g>
      
      <!-- Streams -->
      <g transform="translate(10, 275)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">CHANGE TRACKING</text>
        <g transform="translate(0, 20)">
          <rect width="160" height="55" rx="4" fill="#21262D"/>
          <text x="10" y="18" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">STREAMS</text>
          <text x="10" y="32" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">CDC on RAW tables</text>
          <text x="10" y="45" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">APPEND_ONLY = FALSE</text>
        </g>
      </g>
      
      <!-- Tasks -->
      <g transform="translate(10, 365)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">ORCHESTRATION</text>
        <g transform="translate(0, 20)">
          <rect width="160" height="55" rx="4" fill="#21262D"/>
          <text x="10" y="18" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">TASKS</text>
          <text x="10" y="32" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Serverless compute</text>
          <text x="10" y="45" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">DAG orchestration</text>
        </g>
      </g>
      
      <!-- Schema reference -->
      <g transform="translate(10, 445)">
        <rect width="160" height="50" rx="4" fill="#0D2840"/>
        <text x="80" y="18" text-anchor="middle" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">RAW Schema</text>
        <text x="80" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">PROCUREMENT_DB.RAW</text>
        <text x="80" y="44" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">8 source tables</text>
      </g>
    </g>
  </g>
  
  <!-- ==================== TRANSFORMATION LAYER ==================== -->
  <g transform="translate(440, 80)">
    <rect width="200" height="30" rx="4" fill="#6BCB77" opacity="0.2"/>
    <text x="100" y="20" text-anchor="middle" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">TRANSFORMATION</text>
    
    <g transform="translate(0, 45)" filter="url(#dropShadow)">
      <rect width="200" height="515" rx="10" fill="url(#snowflakeGradient)" stroke="#6BCB77" stroke-width="1"/>
      
      <!-- Dynamic Tables -->
      <g transform="translate(10, 20)">
        <text x="0" y="12" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">DYNAMIC TABLES</text>
        
        <g transform="translate(0, 20)">
          <rect width="180" height="60" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">SUPPLIERS_UNIFIED</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">TARGET_LAG = '1 hour'</text>
          <text x="10" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Dedup + normalize names</text>
          <text x="10" y="52" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="7">200+ suppliers unified</text>
        </g>
        
        <g transform="translate(0, 90)">
          <rect width="180" height="60" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">PO_UNIFIED</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">TARGET_LAG = '1 hour'</text>
          <text x="10" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Currency conversion (USD)</text>
          <text x="10" y="52" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="7">10M+ orders/year</text>
        </g>
        
        <g transform="translate(0, 160)">
          <rect width="180" height="60" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">MARKETPLACE_ENRICHED</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">TARGET_LAG = '1 hour'</text>
          <text x="10" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Risk + ESG + Commodity</text>
          <text x="10" y="52" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="7">100% coverage</text>
        </g>
      </g>
      
      <!-- Transformation logic -->
      <g transform="translate(10, 265)">
        <text x="0" y="12" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">KEY TRANSFORMATIONS</text>
        
        <g transform="translate(0, 20)">
          <rect width="180" height="90" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Supplier Matching:</text>
          <text x="15" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Fuzzy name matching</text>
          <text x="15" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Address normalization</text>
          <text x="15" y="52" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- DUNS number join</text>
          <text x="10" y="68" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Risk Calculation:</text>
          <text x="15" y="80" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Composite scoring</text>
        </g>
      </g>
      
      <!-- Schema reference -->
      <g transform="translate(10, 390)">
        <rect width="180" height="50" rx="4" fill="#1F3D1F"/>
        <text x="90" y="18" text-anchor="middle" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">ATOMIC Schema</text>
        <text x="90" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">PROCUREMENT_DB.ATOMIC</text>
        <text x="90" y="44" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">6 dynamic tables</text>
      </g>
      
      <!-- Benefits box -->
      <g transform="translate(10, 455)">
        <rect width="180" height="45" rx="4" fill="#21262D"/>
        <text x="90" y="15" text-anchor="middle" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Declarative ETL Benefits</text>
        <text x="90" y="28" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">No orchestration code</text>
        <text x="90" y="40" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Automatic incremental refresh</text>
      </g>
    </g>
  </g>
  
  <!-- ==================== ML/AI LAYER ==================== -->
  <g transform="translate(660, 80)">
    <rect width="200" height="30" rx="4" fill="#FFD93D" opacity="0.2"/>
    <text x="100" y="20" text-anchor="middle" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">ML / AI SERVICES</text>
    
    <g transform="translate(0, 45)" filter="url(#dropShadow)">
      <rect width="200" height="515" rx="10" fill="url(#snowflakeGradient)" stroke="#FFD93D" stroke-width="1"/>
      
      <!-- Snowpark ML -->
      <g transform="translate(10, 20)">
        <text x="0" y="12" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">SNOWPARK ML</text>
        
        <g transform="translate(0, 20)">
          <rect width="180" height="95" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Demand Sensing Model</text>
          <text x="10" y="30" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Algorithm: XGBoost Regressor</text>
          <text x="10" y="43" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Target: forecasted_demand_qty</text>
          <text x="10" y="56" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Horizon: 90 days</text>
          <text x="10" y="72" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="7">Features:</text>
          <text x="15" y="84" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="6">lag_7d, lag_30d, construction_idx, clinical_spend</text>
        </g>
        
        <g transform="translate(0, 125)">
          <rect width="180" height="50" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Model Registry</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Versioned model artifacts</text>
          <text x="10" y="40" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="7">Accuracy: 88% (+12%)</text>
        </g>
      </g>
      
      <!-- Cortex AI -->
      <g transform="translate(10, 210)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">CORTEX AI</text>
        
        <g transform="translate(0, 20)">
          <rect width="180" height="65" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Cortex Analyst</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Semantic Model: procurement_model.yaml</text>
          <text x="10" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Measures: spend, ppv, otd, carbon</text>
          <text x="10" y="52" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Dims: supplier, category, region</text>
        </g>
        
        <g transform="translate(0, 95)">
          <rect width="180" height="65" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Cortex Search</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Service: SUPPLIER_DOCS_SEARCH</text>
          <text x="10" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Chunking: 512 tokens, 50 overlap</text>
          <text x="10" y="52" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Embedding: e5-base-v2</text>
        </g>
        
        <g transform="translate(0, 170)">
          <rect width="180" height="50" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Cortex Agent</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Routes to Analyst or Search</text>
          <text x="10" y="40" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Compound query handling</text>
        </g>
      </g>
      
      <!-- Output tables -->
      <g transform="translate(10, 455)">
        <rect width="180" height="45" rx="4" fill="#3D3D1F"/>
        <text x="90" y="15" text-anchor="middle" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">ML Output Tables</text>
        <text x="90" y="28" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">DEMAND_FORECAST_PREDICTIONS</text>
        <text x="90" y="40" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">SHOULD_COST_ANALYSIS</text>
      </g>
    </g>
  </g>
  
  <!-- ==================== CONSUMPTION LAYER ==================== -->
  <g transform="translate(880, 80)">
    <rect width="180" height="30" rx="4" fill="#29B5E8" opacity="0.2"/>
    <text x="90" y="20" text-anchor="middle" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">CONSUMPTION</text>
    
    <g transform="translate(0, 45)" filter="url(#dropShadow)">
      <rect width="180" height="515" rx="10" fill="url(#snowflakeGradient)" stroke="#29B5E8" stroke-width="1"/>
      
      <!-- Mart Views -->
      <g transform="translate(10, 20)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">MART VIEWS</text>
        
        <g transform="translate(0, 20)">
          <rect width="160" height="40" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">V_EXECUTIVE_KPIS</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Aggregated spend, risk, ESG</text>
        </g>
        <g transform="translate(0, 50)">
          <rect width="160" height="40" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">V_SUPPLIER_RISK</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Risk level, revenue at risk</text>
        </g>
        <g transform="translate(0, 100)">
          <rect width="160" height="40" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">V_SHOULD_COST</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Contract vs market variance</text>
        </g>
        <g transform="translate(0, 150)">
          <rect width="160" height="40" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">V_DEMAND_FORECAST</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">90-day predictions + CI</text>
        </g>
      </g>
      
      <!-- Caching -->
      <g transform="translate(10, 240)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">CACHING</text>
        <g transform="translate(0, 20)">
          <rect width="160" height="55" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Result Cache</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">24-hour query result cache</text>
          <text x="10" y="42" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Streamlit @st.cache_data(300s)</text>
        </g>
      </g>
      
      <!-- Access control -->
      <g transform="translate(10, 330)">
        <text x="0" y="12" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">ACCESS CONTROL</text>
        <g transform="translate(0, 20)">
          <rect width="160" height="70" rx="4" fill="#21262D"/>
          <text x="10" y="15" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Row Access Policies</text>
          <text x="10" y="28" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Division-level filtering</text>
          <text x="10" y="42" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Column Masking</text>
          <text x="10" y="55" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">PII protection</text>
        </g>
      </g>
      
      <!-- Schema reference -->
      <g transform="translate(10, 430)">
        <rect width="160" height="70" rx="4" fill="#0D2840"/>
        <text x="80" y="18" text-anchor="middle" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">MART Schema</text>
        <text x="80" y="32" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">PROCUREMENT_DB.MART</text>
        <text x="80" y="44" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">6 secure views</text>
        <text x="80" y="58" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Role-based access</text>
      </g>
    </g>
  </g>
  
  <!-- ==================== APPLICATION LAYER ==================== -->
  <g transform="translate(1080, 80)">
    <rect width="290" height="30" rx="4" fill="#FF4B4B" opacity="0.2"/>
    <text x="145" y="20" text-anchor="middle" fill="#FF4B4B" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">APPLICATION</text>
    
    <g transform="translate(0, 45)" filter="url(#dropShadow)">
      <rect width="290" height="515" rx="10" fill="#21262D" stroke="#FF4B4B" stroke-width="1"/>
      
      <!-- Streamlit header -->
      <g transform="translate(10, 15)">
        <rect width="270" height="35" rx="6" fill="#FF4B4B" opacity="0.15"/>
        <text x="135" y="23" text-anchor="middle" fill="#FF4B4B" font-family="Inter, system-ui, sans-serif" font-size="11" font-weight="600">STREAMLIT IN SNOWFLAKE</text>
      </g>
      
      <!-- App pages -->
      <g transform="translate(10, 65)">
        <rect width="130" height="90" rx="6" fill="#2D333B"/>
        <rect width="4" height="90" rx="2" fill="#29B5E8"/>
        <text x="15" y="20" fill="#29B5E8" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">Executive Tower</text>
        <text x="15" y="35" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Global risk map</text>
        <text x="15" y="47" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- KPI dashboard</text>
        <text x="15" y="59" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- ESG targets</text>
        <text x="15" y="71" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Cortex summary</text>
        <text x="15" y="83" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="6">Persona: CPO</text>
      </g>
      
      <g transform="translate(150, 65)">
        <rect width="130" height="90" rx="6" fill="#2D333B"/>
        <rect width="4" height="90" rx="2" fill="#6BCB77"/>
        <text x="15" y="20" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">Category Workbench</text>
        <text x="15" y="35" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Should-Cost chart</text>
        <text x="15" y="47" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Invoice variance</text>
        <text x="15" y="59" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Cortex Agent chat</text>
        <text x="15" y="71" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Renegotiation AI</text>
        <text x="15" y="83" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="6">Persona: Category Mgr</text>
      </g>
      
      <g transform="translate(10, 165)">
        <rect width="130" height="90" rx="6" fill="#2D333B"/>
        <rect width="4" height="90" rx="2" fill="#FFD93D"/>
        <text x="15" y="20" fill="#FFD93D" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">Data Science WB</text>
        <text x="15" y="35" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Model metrics</text>
        <text x="15" y="47" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Feature importance</text>
        <text x="15" y="59" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Forecast outputs</text>
        <text x="15" y="71" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Correlation explorer</text>
        <text x="15" y="83" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="6">Persona: Data Scientist</text>
      </g>
      
      <g transform="translate(150, 165)">
        <rect width="130" height="90" rx="6" fill="#2D333B"/>
        <rect width="4" height="90" rx="2" fill="#8B949E"/>
        <text x="15" y="20" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">About</text>
        <text x="15" y="35" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Executive overview</text>
        <text x="15" y="47" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Technical deep-dive</text>
        <text x="15" y="59" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Data architecture</text>
        <text x="15" y="71" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Sample queries</text>
        <text x="15" y="83" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="6">Dual-audience</text>
      </g>
      
      <!-- Tech stack -->
      <g transform="translate(10, 275)">
        <text x="0" y="12" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">TECH STACK</text>
        <g transform="translate(0, 20)">
          <rect width="270" height="80" rx="4" fill="#2D333B"/>
          <text x="10" y="18" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Python 3.11 | Streamlit 1.x</text>
          <text x="10" y="32" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Visualization: Altair, Plotly, Pydeck</text>
          <text x="10" y="46" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">Data: snowflake-snowpark-python</text>
          <text x="10" y="60" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="8">State: st.session_state</text>
          <text x="10" y="74" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">Anaconda channel packages only</text>
        </g>
      </g>
      
      <!-- Deployment -->
      <g transform="translate(10, 390)">
        <text x="0" y="12" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="9" font-weight="600">DEPLOYMENT</text>
        <g transform="translate(0, 20)">
          <rect width="270" height="90" rx="4" fill="#2D333B"/>
          <text x="10" y="18" fill="#FF4B4B" font-family="Inter, system-ui, sans-serif" font-size="8" font-weight="500">Streamlit in Snowflake (Native)</text>
          <text x="10" y="32" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Native Snowflake deployment</text>
          <text x="10" y="44" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- SSO via Snowflake auth</text>
          <text x="10" y="56" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Role-based data access</text>
          <text x="10" y="68" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">- Warehouse: STREAMLIT_WH (XS)</text>
          <text x="10" y="80" fill="#6BCB77" font-family="Inter, system-ui, sans-serif" font-size="7">No infrastructure management</text>
        </g>
      </g>
    </g>
  </g>
  
  <!-- ==================== FLOW ARROWS ==================== -->
  <!-- Sources to Ingestion -->
  <g stroke="#444C56" stroke-width="1.5" fill="none" marker-end="url(#arrowGray)">
    <path d="M220,280 L235,280"/>
    <path d="M220,420 L235,350"/>
  </g>
  
  <!-- Ingestion to Transformation -->
  <g stroke="#29B5E8" stroke-width="1.5" fill="none" marker-end="url(#arrowBlue)">
    <path d="M420,320 L435,320"/>
  </g>
  
  <!-- Transformation to ML -->
  <g stroke="#6BCB77" stroke-width="1.5" fill="none" marker-end="url(#arrowGreen)">
    <path d="M640,320 L655,320"/>
  </g>
  
  <!-- ML to Consumption -->
  <g stroke="#FFD93D" stroke-width="1.5" fill="none">
    <path d="M860,320 L875,320" marker-end="url(#arrowBlue)"/>
  </g>
  
  <!-- Consumption to App -->
  <g stroke="#29B5E8" stroke-width="1.5" fill="none" marker-end="url(#arrowBlue)">
    <path d="M1060,320 L1075,320"/>
  </g>
  
  <!-- Bottom legend/governance bar -->
  <g transform="translate(20, 620)">
    <rect width="1360" height="75" rx="8" fill="#21262D"/>
    
    <!-- Governance section -->
    <g transform="translate(20, 15)">
      <text x="0" y="12" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="600">GOVERNANCE &amp; SECURITY</text>
      <g transform="translate(0, 22)">
        <rect width="8" height="8" rx="1" fill="#29B5E8"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">RBAC: 3 app roles (exec, category_mgr, data_scientist)</text>
      </g>
      <g transform="translate(0, 38)">
        <rect width="8" height="8" rx="1" fill="#6BCB77"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">Row-level security on division (Industrial / BioFlow)</text>
      </g>
    </g>
    
    <g transform="translate(400, 15)">
      <text x="0" y="12" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="600">DATA FRESHNESS</text>
      <g transform="translate(0, 22)">
        <rect width="8" height="8" rx="1" fill="#FFD93D"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">Dynamic Tables: TARGET_LAG = 1 hour</text>
      </g>
      <g transform="translate(0, 38)">
        <rect width="8" height="8" rx="1" fill="#FF6B6B"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">Marketplace: Live data sharing (no copy)</text>
      </g>
    </g>
    
    <g transform="translate(750, 15)">
      <text x="0" y="12" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="600">COMPUTE</text>
      <g transform="translate(0, 22)">
        <rect width="8" height="8" rx="1" fill="#29B5E8"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">ETL: Serverless tasks + Dynamic Table compute</text>
      </g>
      <g transform="translate(0, 38)">
        <rect width="8" height="8" rx="1" fill="#6BCB77"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">ML: Snowpark-optimized warehouse (M)</text>
      </g>
    </g>
    
    <g transform="translate(1100, 15)">
      <text x="0" y="12" fill="#FFFFFF" font-family="Inter, system-ui, sans-serif" font-size="10" font-weight="600">MONITORING</text>
      <g transform="translate(0, 22)">
        <rect width="8" height="8" rx="1" fill="#FF4B4B"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">Query history + Usage views</text>
      </g>
      <g transform="translate(0, 38)">
        <rect width="8" height="8" rx="1" fill="#8B949E"/>
        <text x="15" y="8" fill="#8B949E" font-family="Inter, system-ui, sans-serif" font-size="9">Cost attribution by warehouse</text>
      </g>
    </g>
  </g>
  
  <!-- Footer -->
  <text x="700" y="720" text-anchor="middle" fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="10">Snowcore Industries | Technical Architecture - L2 Detailed Implementation View</text>
  
  <!-- Data flow volume annotations -->
  <g fill="#6E7681" font-family="Inter, system-ui, sans-serif" font-size="7">
    <text x="228" y="260">Daily</text>
    <text x="228" y="270">batch</text>
    <text x="428" y="305">Continuous</text>
    <text x="648" y="305">On-demand</text>
    <text x="868" y="305">Cached</text>
    <text x="1068" y="305">Real-time</text>
  </g>
</svg>
